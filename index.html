<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>업무지원 확인서</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- PDF, Excel 라이브러리 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f7;
      color: #222;
    }
    .layout {
      display: flex;
      min-height: 100vh;
    }
    .main {
      flex: 1;
      padding: 24px;
      max-width: 1100px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-gap: 20px;
    }
    h1 {
      grid-column: 1 / -1;
      margin: 0 0 6px;
      font-size: 22px;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    .logo {
      height: 30px;
    }
    .subtitle {
      grid-column: 1 / -1;
      font-size: 13px;
      color: #666;
      margin-bottom: 12px;
      text-align: center;
    }
    .card {
      background: #fff;
      border-radius: 18px;
      padding: 18px 20px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.06);
    }
    .card h2 {
      margin: 0 0 10px;
      font-size: 16px;
    }
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-gap: 10px;
      margin-bottom: 8px;
    }
    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 13px;
    }
    label {
      color: #555;
    }
    input {
      padding: 7px 9px;
      border-radius: 8px;
      border: 1px solid #d0d0d7;
      font-size: 13px;
      outline: none;
    }
    input:focus {
      border-color: #ffb400;
      box-shadow: 0 0 0 1px rgba(255, 179, 0, 0.3);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }
    th, td {
      border: 1px solid #000;
      padding: 6px 4px;
      text-align: center;
    }
    th {
      background: #fafafa;
    }
    .btn-panel {
      width: 190px;
      padding: 24px 16px;
      border-left: 1px solid #e0e0e5;
      background: #fcfcfd;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .btn {
      border: none;
      border-radius: 999px;
      padding: 9px 14px;
      font-size: 13px;
      cursor: pointer;
      display: block;
      width: 100%;
      text-align: center;
      background: #ffcc33;
      font-weight: 600;
      color: #333;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }
    .btn-secondary {
      background: #fff;
      border: 1px solid #ddd;
      box-shadow: none;
    }
    .btn:active {
      transform: translateY(1px);
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    }
    .preview-logo-wrap {
      text-align: center;
      margin-bottom: 4px;
    }
    .preview-logo {
      height: 30px;
    }
    .preview-title {
      text-align: center;
      font-weight: 700;
      font-size: 18px;
      margin-bottom: 10px;
    }
    .section-title {
      font-size: 13px;
      font-weight: 600;
      margin: 8px 0;
    }
    .reg-text {
      font-size: 11px;
      line-height: 1.6;
    }
    .bottom-line {
      margin-top: 30px;
      font-size: 12px;
      text-align: center;
      line-height: 2;
    }
    @media (max-width: 960px) {
      .layout {
        flex-direction: column;
      }
      .main {
        grid-template-columns: 1fr;
      }
      .btn-panel {
        width: 100%;
        border-left: none;
        border-top: 1px solid #e0e0e5;
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
      }
      .btn {
        width: calc(50% - 10px);
      }
    }
  </style>
</head>
<body>
<div class="layout">
  <div class="main">
    <h1>
      <img src="logo.png" alt="모기지리더스 로고" class="logo" />
      업무지원 확인서
    </h1>
    <div class="subtitle">
      대출 실행 계약에 대한 주모집자·공동모집자의 업무지원을 확인하고,
      내부 수수료 배분(주 60% / 공동 40%) 근거로 활용하는 양식입니다.
    </div>

    <!-- 입력 카드 -->
    <div class="card" id="input-card">
      <h2>1. 대출 실행 계약 정보</h2>
      <div class="form-row">
        <div class="field">
          <label for="financialInstitution">금융기관</label>
          <input id="financialInstitution" />
        </div>
        <div class="field">
          <label for="productName">상품명</label>
          <input id="productName" />
        </div>
      </div>
      <div class="form-row">
        <div class="field">
          <label for="loanAmount">대출금액(원)</label>
          <input id="loanAmount" />
        </div>
        <div class="field">
          <label for="execDate">실행일자</label>
          <input id="execDate" type="date" />
        </div>
      </div>
      <div class="form-row">
        <div class="field">
          <label for="regNoMain">등록번호(주모집자)</label>
          <input id="regNoMain" />
        </div>
        <div class="field">
          <label for="groupNo">*단체협의번호(집단대출)</label>
          <input id="groupNo" />
        </div>
      </div>

      <h2 style="margin-top:18px;">2. 업무지원 참여자</h2>
      <table>
        <thead>
        <tr>
          <th style="width:80px;">구 분</th>
          <th>등록번호</th>
          <th>성명</th>
          <th>서명(텍스트)</th>
        </tr>
        </thead>
        <tbody>
        <tr>
          <td>주모집자</td>
          <td><input id="mainRegNo" /></td>
          <td><input id="mainName" /></td>
          <td><input id="mainSign" /></td>
        </tr>
        <tr>
          <td>공동모집자</td>
          <td><input id="jointRegNo" /></td>
          <td><input id="jointName" /></td>
          <td><input id="jointSign" /></td>
        </tr>
        </tbody>
      </table>

      <div class="field" style="margin-top:14px;">
        <label for="teamName">관리팀(팀명)</label>
        <input id="teamName" placeholder="예: 대출영업1" />
      </div>
    </div>

    <!-- 미리보기 / PDF 영역 -->
    <div class="card" id="preview-card">
      <div id="pdfArea">
        <div class="preview-logo-wrap">
          <img src="logo.png" alt="모기지리더스 로고" class="preview-logo" />
        </div>
        <div class="preview-title">업무지원 확인서</div>

        <!-- 1. 대출 실행 계약 정보 -->
        <div class="section-title">1. 대출 실행 계약 정보</div>
        <table style="margin-bottom:12px;">
          <tbody>
          <tr>
            <th style="width:120px;">금융기관</th>
            <td id="pv_financialInstitution"></td>
          </tr>
          <tr>
            <th>상품명</th>
            <td id="pv_productName"></td>
          </tr>
          <tr>
            <th>대출금액(원)</th>
            <td id="pv_loanAmount"></td>
          </tr>
          <tr>
            <th>실행일자</th>
            <td id="pv_execDate"></td>
          </tr>
          <tr>
            <th>등록번호(주모집자)</th>
            <td id="pv_regNoMain"></td>
          </tr>
          <tr>
            <th>*단체협의번호(집단대출)</th>
            <td id="pv_groupNo"></td>
          </tr>
          </tbody>
        </table>

        <!-- 2. 업무지원 참여자 -->
        <div class="section-title">2. 업무지원 참여자</div>
        <table style="margin-bottom:12px;">
          <thead>
          <tr>
            <th style="width:80px;">구 분</th>
            <th>등록번호</th>
            <th>성명</th>
            <th>서명</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>주모집자</td>
            <td id="pv_mainRegNo"></td>
            <td id="pv_mainName"></td>
            <td id="pv_mainSign"></td>
          </tr>
          <tr>
            <td>공동모집자</td>
            <td id="pv_jointRegNo"></td>
            <td id="pv_jointName"></td>
            <td id="pv_jointSign"></td>
          </tr>
          </tbody>
        </table>

        <!-- 3. 내부 정산 규정 -->
        <div class="section-title">3. 내부 정산 규정</div>
        <div class="reg-text">
          1) 업무지원 건의 수수료 배분은 회사 규정에 따라 <strong>주모집자 60%, 공동모집자 40%</strong> 비율로 고정하여 산정합니다.<br/>
          2) 대출실행계약과 관련한 민원, 리스크, 패널티는 주모집자에게 귀속됩니다.<br/>
          3) 본 문서는 관련 법령 및 회사 규정에 따라 5년간 보관됩니다.
        </div>

        <!-- 날짜 & 관리팀장 -->
        <div class="bottom-line">
          20&nbsp;&nbsp;&nbsp;&nbsp;년&nbsp;&nbsp;&nbsp;&nbsp;월&nbsp;&nbsp;&nbsp;&nbsp;일<br/><br/>
          모기지리더스&nbsp;&nbsp;&nbsp;&nbsp;
          <span id="pv_teamName"></span>팀&nbsp;&nbsp;&nbsp;&nbsp;
          관리팀장&nbsp;&nbsp;_______________ (서명)
        </div>
      </div>
    </div>
  </div>

  <!-- 버튼 패널 -->
  <div class="btn-panel">
    <button class="btn" id="btnPdf">PDF로 저장</button>
    <button class="btn btn-secondary" id="btnExcel">엑셀로 저장</button>
    <button class="btn btn-secondary" id="btnReset">입력 초기화</button>
  </div>
</div>

<script>
  // 입력 → 미리보기 동기화
  function syncPreview() {
    const get = id => document.getElementById(id).value.trim();

    document.getElementById('pv_financialInstitution').innerText = get('financialInstitution');
    document.getElementById('pv_productName').innerText = get('productName');
    document.getElementById('pv_loanAmount').innerText = get('loanAmount');
    document.getElementById('pv_execDate').innerText = get('execDate');
    document.getElementById('pv_regNoMain').innerText = get('regNoMain');
    document.getElementById('pv_groupNo').innerText = get('groupNo');

    document.getElementById('pv_mainRegNo').innerText = get('mainRegNo');
    document.getElementById('pv_mainName').innerText = get('mainName');
    document.getElementById('pv_mainSign').innerText = get('mainSign');

    document.getElementById('pv_jointRegNo').innerText = get('jointRegNo');
    document.getElementById('pv_jointName').innerText = get('jointName');
    document.getElementById('pv_jointSign').innerText = get('jointSign');

    document.getElementById('pv_teamName').innerText = get('teamName');
  }

  function bindInputs() {
    document.getElementById('input-card').addEventListener('input', syncPreview);
  }

  // PDF 저장
  function downloadPdf() {
    const element = document.getElementById('pdfArea');
    const opt = {
      margin:       10,
      filename:     '업무지원_확인서.pdf',
      image:        { type: 'jpeg', quality: 0.98 },
      html2canvas:  { scale: 2 },
      jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
    };
    html2pdf().set(opt).from(element).save();
  }

  // 엑셀 저장 (워드 양식과 같은 구조)
  function downloadExcel() {
    const get = id => document.getElementById(id).value.trim();

    const rows = [];
    rows.push(['업무지원 확인서']);
    rows.push([]);
    rows.push(['1. 대출 실행 계약 정보']);
    rows.push(['항목', '값']);
    rows.push(['금융기관', get('financialInstitution')]);
    rows.push(['상품명', get('productName')]);
    rows.push(['대출금액(원)', get('loanAmount')]);
    rows.push(['실행일자', get('execDate')]);
    rows.push(['등록번호(주모집자)', get('regNoMain')]);
    rows.push(['단체협의번호(집단대출)', get('groupNo')]);
    rows.push([]);
    rows.push(['2. 업무지원 참여자']);
    rows.push(['구분', '등록번호', '성명', '서명']);
    rows.push(['주모집자', get('mainRegNo'), get('mainName'), get('mainSign')]);
    rows.push(['공동모집자', get('jointRegNo'), get('jointName'), get('jointSign')]);
    rows.push([]);
    rows.push(['3. 내부 정산 규정']);
    rows.push(['1) 업무지원 건의 수수료 배분은 회사 규정에 따라 주모집자 60%, 공동모집자 40% 비율로 고정하여 산정합니다.']);
    rows.push(['2) 대출실행계약과 관련한 민원, 리스크, 패널티는 주모집자에게 귀속됩니다.']);
    rows.push(['3) 본 문서는 관련 법령 및 회사 규정에 따라 5년간 보관됩니다.']);
    rows.push([]);
    rows.push(['모기지리더스', get('teamName') + '팀', '관리팀장 서명: _____________']);

    const wb = XLSX.utils.book_new();
    const ws = XLSX.utils.aoa_to_sheet(rows);
    XLSX.utils.book_append_sheet(wb, ws, '업무지원확인서');
    XLSX.writeFile(wb, '업무지원_확인서.xlsx');
  }

  // 입력 초기화
  function resetForm() {
    if (!confirm('입력 내용을 모두 지우시겠습니까?')) return;
    const inputs = document.querySelectorAll('#input-card input');
    inputs.forEach(i => i.value = '');
    syncPreview();
  }

  function bindButtons() {
    document.getElementById('btnPdf').addEventListener('click', downloadPdf);
    document.getElementById('btnExcel').addEventListener('click', downloadExcel);
    document.getElementById('btnReset').addEventListener('click', resetForm);
  }

  (function init() {
    bindInputs();
    bindButtons();
    syncPreview();
  })();
</script>
</body>
</html>
